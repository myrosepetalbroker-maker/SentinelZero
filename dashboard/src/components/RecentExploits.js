import React from 'react';
import './RecentExploits.css';

function RecentExploits({ historicalData }) {
  if (!historicalData) return null;

  const recentExploits = [...historicalData.exploits]
    .sort((a, b) => new Date(b.date) - new Date(a.date))
    .slice(0, 5);

  const formatCurrency = (amount) => {
    if (amount >= 1000000000) {
      return `$${(amount / 1000000000).toFixed(2)}B`;
    }
    return `$${(amount / 1000000).toFixed(0)}M`;
  };

  const formatDate = (dateString) => {
    const date = new Date(dateString);
    return date.toLocaleDateString('en-US', { 
      month: 'short', 
      day: 'numeric', 
      year: 'numeric' 
    });
  };

  return (
    <div className="card recent-exploits">
      <h2 className="card-title">⚡ Recent Exploits</h2>
      <p className="card-description">
        Latest documented incidents
      </p>

      <div className="exploits-list">
        {recentExploits.map((exploit) => (
          <div key={exploit.id} className="exploit-item">
            <div className="exploit-header">
              <div className="exploit-protocol">{exploit.protocol_name}</div>
              <div className="exploit-date">{formatDate(exploit.date)}</div>
            </div>
            <div className="exploit-details">
              <span className={`badge badge-${exploit.funds_recovered ? 'low' : 'high'}`}>
                {exploit.attack_type}
              </span>
              <span className="exploit-impact">
                {formatCurrency(exploit.financial_impact_usd)}
              </span>
            </div>
            {exploit.funds_recovered && (
              <div className="exploit-recovered">
                ✅ Funds Recovered
              </div>
            )}
          </div>
        ))}
      </div>

      <a href="#exploits" className="view-all-link">
        View all {historicalData.statistics.total_incidents} exploits →
      </a>
    </div>
  );
}

export default RecentExploits;
